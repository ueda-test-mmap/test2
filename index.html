<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Polygon Drag Generator</title>
  <link rel="stylesheet" href="style.css">
</head>
<style>
    body {
  font-family: sans-serif;
  background: #0b1020;
  color: #fff;
}

.tool {
  display: flex;
  gap: 24px;
  padding: 24px;
}

.preview {
  width: 300px;
  border: 1px solid #333;
  background: #000;
}

svg {
  width: 100%;
  height: auto;
  background: #0b1020;
}

polygon {
  fill: #ffffff;
  filter: drop-shadow(0 0 6px rgba(180,100,255,0.9));
}

.handle {
  fill: #ff66cc;
  cursor: grab;
}

.handle:active {
  cursor: grabbing;
}

.output {
  flex: 1;
}

textarea {
  width: 100%;
  height: 80px;
  background: #111;
  color: #0f0;
  border: 1px solid #333;
  padding: 8px;
  font-family: monospace;
}

</style>
<body>

<div class="tool">
  <div class="preview">
    <svg id="svg" viewBox="0 0 100 100">
      <polygon id="polygon" points="10,60 9,75 20,80"></polygon>

      <!-- ドラッグ用ハンドル -->
      <circle class="handle" cx="10" cy="60" r="2"></circle>
      <circle class="handle" cx="9" cy="75" r="2"></circle>
      <circle class="handle" cx="20" cy="80" r="2"></circle>
    </svg>
  </div>

  <div class="output">
    <label>polygon points</label>
    <textarea id="pointsOutput"></textarea>
  </div>
</div>

<script src="script.js"></script>
</body>
<script>
    const svg = document.getElementById("svg");
const polygon = document.getElementById("polygon");
const handles = document.querySelectorAll(".handle");
const output = document.getElementById("pointsOutput");

let activeHandle = null;

// 初期表示
updateOutput();

// マウスダウン
handles.forEach((handle, index) => {
  handle.addEventListener("mousedown", e => {
    activeHandle = { handle, index };
  });
});

// マウスムーブ
svg.addEventListener("mousemove", e => {
  if (!activeHandle) return;

  const pt = svg.createSVGPoint();
  pt.x = e.clientX;
  pt.y = e.clientY;

  const cursor = pt.matrixTransform(svg.getScreenCTM().inverse());

  activeHandle.handle.setAttribute("cx", cursor.x);
  activeHandle.handle.setAttribute("cy", cursor.y);

  updatePolygon();
});

// マウスアップ
window.addEventListener("mouseup", () => {
  activeHandle = null;
});

function updatePolygon() {
  const points = Array.from(handles)
    .map(h => `${h.getAttribute("cx")},${h.getAttribute("cy")}`)
    .join(" ");

  polygon.setAttribute("points", points);
  updateOutput();
}

function updateOutput() {
  output.value = polygon.getAttribute("points");
}

</script>
</html>
