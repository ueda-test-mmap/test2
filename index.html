<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Polygon Generator Pro</title>

<style>
body{
    margin:0;
    background:#000;
    color:#fff;
    font-family:sans-serif;
    transition:background 0.6s ease;
}

.wrapper{
    display:flex;
    height:100vh;
}

.controls{
    width:320px;
    padding:20px;
    background:#111;
    overflow:auto;
}

.viewer{
    flex:1;
    display:flex;
    justify-content:center;
    align-items:center;
}

svg{
    width:400px;
    height:400px;
}

polygon{
    cursor:move;
}

input{
    width:100%;
    margin-bottom:8px;
    padding:6px;
}

button{
    width:100%;
    padding:6px;
    margin-bottom:10px;
    cursor:pointer;
}

label{
    font-size:13px;
    opacity:.7;
}
</style>
</head>
<body>

<div class="wrapper">

<div class="controls">

<h3>本体カラー</h3>

<label>カラーピッカー</label>
<input type="color" id="colorPicker">

<label>HEX</label>
<input type="text" id="hexInput">

<button onclick="copyHex()">HEXコピー</button>

<label>RGB</label>
<input type="text" id="rgbInput">

<button onclick="copyRGB()">RGBコピー</button>

<hr>

<h3>オーバーレイ</h3>

<label><input type="checkbox" id="overlayToggle" checked> ON / OFF</label>

<input type="color" id="overlayPicker">

<hr>

<h3>Polygon Points</h3>
<input type="text" id="pointsInput">
<button onclick="copyPoints()">Pointsコピー</button>

</div>

<div class="viewer">
<svg viewBox="0 0 100 100">
<polygon id="poly" points="10,60 9,75 20,80"></polygon>
</svg>
</div>

</div>

<script>
const poly = document.getElementById("poly");
const picker = document.getElementById("colorPicker");
const hexInput = document.getElementById("hexInput");
const rgbInput = document.getElementById("rgbInput");
const pointsInput = document.getElementById("pointsInput");
const overlayToggle = document.getElementById("overlayToggle");
const overlayPicker = document.getElementById("overlayPicker");

let overlayColor = "#ffffff";

function hexToRgb(hex){
    let r = parseInt(hex.substr(1,2),16);
    let g = parseInt(hex.substr(3,2),16);
    let b = parseInt(hex.substr(5,2),16);
    return {r,g,b};
}

function rgbToHex(r,g,b){
    return "#" + 
        r.toString(16).padStart(2,"0") +
        g.toString(16).padStart(2,"0") +
        b.toString(16).padStart(2,"0");
}

function updateBackground(r,g,b){
    let brightness = (r*0.299 + g*0.587 + b*0.114);

    if(brightness < 40){
        document.body.style.background = "#fff";
        document.body.style.color = "#000";
    }else{
        document.body.style.background = "#000";
        document.body.style.color = "#fff";
    }
}

function updateColorFromHex(hex){
    if(!/^#([0-9A-F]{6})$/i.test(hex)) return;

    let {r,g,b} = hexToRgb(hex);

    picker.value = hex;
    hexInput.value = hex;
    rgbInput.value = `${r}, ${g}, ${b}`;

    poly.setAttribute("fill", hex);

    if(overlayToggle.checked){
        poly.style.filter = `drop-shadow(0 0 20px ${overlayPicker.value})`;
    }else{
        poly.style.filter = "none";
    }

    updateBackground(r,g,b);
}

picker.addEventListener("input", e=>{
    updateColorFromHex(e.target.value);
});

hexInput.addEventListener("input", e=>{
    updateColorFromHex(e.target.value);
});

rgbInput.addEventListener("input", e=>{
    let parts = e.target.value.split(",");
    if(parts.length !==3) return;
    let r=parseInt(parts[0]);
    let g=parseInt(parts[1]);
    let b=parseInt(parts[2]);
    if(isNaN(r)||isNaN(g)||isNaN(b)) return;
    let hex = rgbToHex(r,g,b);
    updateColorFromHex(hex);
});

overlayPicker.addEventListener("input", ()=>{
    updateColorFromHex(picker.value);
});

overlayToggle.addEventListener("change", ()=>{
    updateColorFromHex(picker.value);
});

pointsInput.value = poly.getAttribute("points");

pointsInput.addEventListener("input", e=>{
    poly.setAttribute("points", e.target.value);
});

function copyHex(){
    navigator.clipboard.writeText(hexInput.value);
}

function copyRGB(){
    navigator.clipboard.writeText(rgbInput.value);
}

function copyPoints(){
    navigator.clipboard.writeText(pointsInput.value);
}

updateColorFromHex("#ff4d6d");
</script>

</body>
</html>
